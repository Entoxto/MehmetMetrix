---
description: Правила для Python-пайплайна Excel → JSON
globs: Excel/**
alwaysApply: false
---

# Excel-пайплайн (Excel/)

## Архитектура пайплайна

```
fetch_google_sheet.py → скачивает xlsx из Google Sheets
        ↓
parse_excel.py → парсит Excel → data/shipments.json (автоматически вызывает update_prices.py)
        ↓
update_prices.py → обновляет price/cost в data/products.json из поставок
```

## Перед изменениями

Прочитай `Excel/логика парсинга.txt` — там полная спецификация маппинга колонок, определения границ поставок и разделителей годов.

## Ключевые колонки Excel

| Колонка | Поле в JSON | Валюта |
|---------|------------|--------|
| A (№ Поставки) | `id`, `title` | — |
| C (Наименование) | `overrideName` | — |
| E (Статусы позиций) | `status` (строка как есть) | — |
| F (Статусы поставок) | `status` поставки (строка как есть) | — |
| G (Кол-во) | `sizes` / `quantityOverride` | — |
| H (Стоймость 1 ед $) | `price` | $ (доллары) |
| N (Себестоймость с учётом карго) | `cost` | ₽ (рубли) |
| P (Дата поступления) | `receivedDate` / `eta` | — |

## Правила

1. Статусы прокидываются из Excel **как есть** — без маппинга, без enum.
2. `parse_excel.py` автоматически вызывает `update_prices.py` в конце — не нужно запускать отдельно.
3. После изменения парсера обнови `Excel/логика парсинга.txt` и секцию README.md.
4. Python-скрипты должны работать в **PowerShell на Windows**. Используй `python`, не `python3`.
